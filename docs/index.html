<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="João Martins" />


<title>Swiss Participation in Horizon 2020</title>

<script src="index_files/header-attrs-2.7/header-attrs.js"></script>
<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/navigation-1.1/codefolding.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>
<script src="index_files/core-js-2.5.3/shim.min.js"></script>
<script src="index_files/react-17.0.0/react.min.js"></script>
<script src="index_files/react-17.0.0/react-dom.min.js"></script>
<script src="index_files/reactwidget-1.0.0/react-tools.js"></script>
<script src="index_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="index_files/reactable-binding-0.2.3/reactable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Swiss Participation in Horizon 2020</h1>
<h4 class="author">João Martins</h4>

</div>


<pre class="r"><code># source code: https://github.com/zambujo/swissparticipation
library(tidyverse)
library(janitor)
library(lubridate)
library(here)
library(glue)
library(readxl)
library(scales)
library(ggsci)
library(ggrepel)
library(ggtext)
library(reactable)
library(countrycode)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
int &lt;- function(x) as.integer(x)
chr &lt;- function(x) as.character(x)
roman &lt;- function(x) as.roman(x)</code></pre>
<!-- badges: start -->
<p><a href="https://github.com/zambujo/swissparticipation"><img
src="https://img.shields.io/github/watchers/zambujo/swissparticipation?style=social" /></a>
<a href="https://github.com/zambujo/swissparticipation/issues"><img
src="https://img.shields.io/github/issues/zambujo/swissparticipation" /></a>
<!-- badges: end --></p>
<blockquote>
<p>Pease find related statistics on the SERI’s page: <a
href="https://www.sbfi.admin.ch/sbfi/en/home/research-and-innovation/international-cooperation-r-and-i/eu-framework-programmes-for-research/f-f-swiss-participation.html">Facts
and Figures on the Swiss Participation in the EU-Framework Programmes
for Research and Innovation</a>.</p>
</blockquote>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Source: <a
href="https://webgate.ec.europa.eu/dashboard/single/?appid=93297a69-09fd-4ef5-889f-b83c4e21d33e&amp;sheet=c616ed33-064c-40c0-803a-e75045b78c05"><strong>Horizon
2020 Dashboard data</strong></a>, last updated on 2021-12-06 (see <a
href="#raw-data">Annex: Raw Data</a>).</p>
<pre class="r"><code># TODO: update main text
# TODO: to separate script
# INFO: Qlik Sense dashboard data need to be downloaded by hand
&quot;https://cordis.europa.eu/data/cordis-fp7projects-csv.zip&quot; %&gt;%
  download.file(here(&quot;data-raw&quot;, &quot;cordis-fp7projects-csv.zip&quot;))
unzip(
  here(&quot;data-raw&quot;, &quot;cordis-fp7projects-csv.zip&quot;),
  exdir = here(&quot;data-raw&quot;, &quot;fp7&quot;))  

&quot;https://cordis.europa.eu/data/cordis-h2020projects-csv.zip&quot; %&gt;%
  download.file(here(&quot;data-raw&quot;, &quot;cordis-h2020projects-csv.zip&quot;))
unzip(
  here(&quot;data-raw&quot;, &quot;cordis-h2020projects-csv.zip&quot;),
  exdir = here(&quot;data-raw&quot;, &quot;h2020&quot;))  </code></pre>
<pre class="r"><code># TODO: to separate script
fp7_dashboard &lt;- here(&quot;data-raw&quot;, &quot;fp7-projects.xlsx&quot;) %&gt;%
  read_excel() %&gt;%
  clean_names() %&gt;%
  select(
    project_id = project_nbr,
    thematic_priority = thematic_priority_descr,
    topic_code,
    topic_description)

h2020_dashboard &lt;- here(&quot;data-raw&quot;, &quot;h2020-projects.xlsx&quot;) %&gt;%
  read_excel() %&gt;%
  clean_names() %&gt;%
  select(
    project_id = project_nbr,
    thematic_priority = thema,
    topic_code,
    topic_description)

projects_dashboard &lt;-
  fp7_dashboard %&gt;%
  bind_rows(h2020_dashboard)

projects_cordis &lt;-
  read_csv2(here(&quot;data-raw&quot;, &quot;fp7&quot;, &quot;csv&quot;, &quot;project.csv&quot;)) %&gt;%
  bind_rows(read_csv2(here(&quot;data-raw&quot;, &quot;h2020&quot;, &quot;csv&quot;, &quot;project.csv&quot;))) %&gt;%
  clean_names() %&gt;%
  select(
    project_id = id,
    rcn,
    proj_acronym = acronym,
    start_date,
    end_date,
    legal_basis,
    framework_programme,
    funding_scheme
  )

projects &lt;- projects_cordis %&gt;%
  left_join(projects_dashboard, by = &quot;project_id&quot;)

rm(fp7_dashboard, h2020_dashboard, projects_dashboard, projects_cordis)

organizations_cordis &lt;-
  read_csv2(here(&quot;data-raw&quot;, &quot;fp7&quot;, &quot;csv&quot;, &quot;organization.csv&quot;)) %&gt;%
  bind_rows(read_csv2(here(
    &quot;data-raw&quot;, &quot;h2020&quot;, &quot;csv&quot;, &quot;organization.csv&quot;
  ))) %&gt;%
  clean_names() %&gt;%
  select(
    project_id,
    project_acronym,
    pic = organisation_id,
    legal_name = name,
    legal_short_name = short_name,
    legal_entity_type = activity_type,
    country_code = country,
    legal_url = organization_url,
    partner_role = role,
    ec_contribution,
    net_ec_contribution
  ) %&gt;%
  mutate(net_ec_contribution = if_else(
    !is.na(net_ec_contribution),
    net_ec_contribution,
    ec_contribution
  ))

h2020_dashboard &lt;- here(&quot;data-raw&quot;, &quot;horizon2020.xlsx&quot;) %&gt;%
  read_excel() %&gt;%
  clean_names() %&gt;%
  select(
    project_id = project_nbr,
    pic = general_pic,
    partner_role,
    pillar_abbr,
    pillar_descr,
    thematic_priority_abbr,
    signature_date,
    call_deadline_date,
    eu_contribution
  ) %&gt;%
  mutate(partner_role = str_to_lower(partner_role))

organizations &lt;- organizations_cordis %&gt;%
  left_join(h2020_dashboard,
            by = c(&quot;project_id&quot;, &quot;pic&quot;, &quot;partner_role&quot;))

df_raw &lt;- organizations %&gt;% 
  left_join(projects, by = &quot;project_id&quot;) %&gt;%
  mutate(
    # rename role
    partner_role = str_to_title(partner_role),
    # factorize pillars
    pillar = str_extract(pillar_abbr, &quot;\\d&quot;),
    pillar = if_else(pillar_abbr == &quot;EU.0.&quot;, &quot;Cross-theme&quot;, pillar),
    pillar = if_else(pillar_abbr == &quot;Euratom&quot;, pillar_abbr, pillar),
    pillar = fct_inseq(pillar),
    pillar = fct_rev(pillar),
    pillar = fct_relevel(pillar, &quot;Cross-theme&quot;, after = 0),
    pillar = fct_recode(
      pillar, I = &quot;1&quot;, II = &quot;2&quot;, III = &quot;3&quot;, IV = &quot;4&quot;, V = &quot;5&quot;),
    # group entity types
    legal_entity_type = str_sub(legal_entity_type, 1, 3),
    org_type = fct_collapse(
      legal_entity_type,
      `Research &amp; Education` = c(&quot;HES&quot;, &quot;REC&quot;),
      `Others (Excl. R&amp;Ed)` = c(&quot;PRC&quot;, &quot;PUB&quot;, &quot;OTH&quot;)),
    # import EU contribution
    eu_contribution = str_replace(eu_contribution, fixed(&quot;-&quot;), &quot;0&quot;),
    eu_contribution = as.numeric(eu_contribution),
    # import country code
    country_code = str_sub(country_code, 1, 2),
    country = countrycode(country_code, &quot;eurostat&quot;, &quot;country.name.en&quot;),
    # import dates
    signature_date = as.Date(signature_date, format = &quot;%d/%m/%Y&quot;),
    call_deadline_date = as.Date(call_deadline_date, format = &quot;%d/%m/%Y&quot;),
    signature_year = str_sub(signature_date, 1, 4),
    call_year = str_sub(call_deadline_date, 1, 4),
    start_year = str_sub(start_date, 1, 4),
    signature_year = int(signature_year),
    call_year = int(call_year),
    start_year = int(start_year)
  )

# TODO: save file in data</code></pre>
<pre class="r"><code>df &lt;- df_raw %&gt;%
  filter(framework_programme == &quot;H2020&quot;) %&gt;%
  filter(legal_name != &quot;EUROPEAN ORGANIZATION FOR NUCLEAR RESEARCH&quot;)</code></pre>
</div>
<div id="total-eu-contribution-by-pillar-all-countries"
class="section level2">
<h2>Total EU Contribution by Pillar: All Countries</h2>
<pre class="r"><code>ggp &lt;- df %&gt;%
  mutate(
    pillar = fct_other(pillar, keep = chr(roman(1:5))),
    pillar = fct_relevel(pillar, &quot;Other&quot;, after = 0)) %&gt;%
  filter(!is.na(pillar)) %&gt;%
  group_by(pillar) %&gt;%
  summarise(size_pillar = sum(eu_contribution)) %&gt;%
  mutate(share = 100 * prop.table(size_pillar),
         fp = &quot;H2020&quot;) %&gt;%
  ggplot(aes(x = fp,  y = size_pillar, fill = pillar)) +
  geom_col(position = position_stack()) +
  geom_text(
    aes(label = sprintf(&quot;%.1f%%&quot;, share)),
    position = position_stack(vjust = 0.5),
    size = 4,
    fontface = &quot;bold&quot;
  ) +
  coord_flip() +
  scale_fill_nejm(alpha = .5, guide = guide_legend(reverse = TRUE)) +
  theme_minimal(base_size = 14) +
  labs(x = NULL, y = NULL) +
  theme(
    legend.position = &quot;bottom&quot;,
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank()
  )

ggsave(&quot;budget-allocation.svg&quot;,
       plot = ggp,
       w = 12,
       h = 3)</code></pre>
<p><img
src="https://raw.githubusercontent.com/zambujo/swissparticipation/main/data/budget-allocation.svg"
title="Total EU contribution to the different pillars in H2020." /></p>
</div>
<div id="top-participating-countries" class="section level2">
<h2>Top Participating Countries</h2>
<p>Participation count, number of projects (distinct), and total EU
contribution for the top 10 participating countries (by total EU
contribution).</p>
<pre class="r"><code># find and sort top participants
top_participants &lt;- df %&gt;%
  group_by(Country = country) %&gt;%
  summarise(contrib_country = sum(eu_contribution, na.rm = TRUE)) %&gt;%
  ungroup() %&gt;%
  arrange(desc(contrib_country))

ch_rank &lt;- which(pull(top_participants, Country) == &quot;Switzerland&quot;)

# calculate further participation statistics
country_participation &lt;- df %&gt;%
  group_by(
    Country = country,
    `Call Year` = call_year,
    Type = org_type) %&gt;%
  summarise(
    `Participation Count` = n(),
    `Nb Projects` = n_distinct(project_id),
    `EU Contribution` = sum(eu_contribution, na.rm = TRUE)) %&gt;%
  ungroup() %&gt;%
  arrange(`Type`, `Call Year`)

# show with reactable
top_participants %&gt;%
  select(Country) %&gt;%
  head(10) %&gt;%
  inner_join(country_participation, by = &quot;Country&quot;) %&gt;%
  reactable(
    groupBy = c(&quot;Country&quot;, &quot;Call Year&quot;),
    columns = list(
      `Participation Count` = colDef(
        aggregate = &quot;sum&quot;,
        format = colFormat(separators = TRUE)),
      `Nb Projects` = colDef(
        aggregate = &quot;sum&quot;,
        format = colFormat(separators = TRUE)),
      `EU Contribution` = colDef(
        aggregate = &quot;sum&quot;,
        format = colFormat(
          currency = &quot;EUR&quot;,
          separators = TRUE,
          digits = 2))),
    highlight = TRUE,
    compact = TRUE
  )</code></pre>
<div id="htmlwidget-22f9e563420213578966" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-22f9e563420213578966">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Country":["Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria"],"Call Year":[2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2016,2018,2019,2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2018,2019,2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2017,2018,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2015,2016,2018,2021,2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA",2014,2015,2016,2017,2018,2019,2020,2021,"NA"],"Type":["Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)",null,null,null,"Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)",null,null,"Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)",null,null,null,"Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)",null,null,null,null,"Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Research & Education","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)","Others (Excl. R&Ed)"],"Participation Count":[1613,1413,1486,1448,1639,1780,1552,97,347,1096,939,1262,1047,1167,1264,1105,94,837,1882,1715,1708,1539,1546,1428,1163,53,253,895,755,1023,687,618,566,446,37,722,1,3,1,778,671,775,765,850,948,799,52,1025,1056,888,1334,1094,1358,1424,1208,116,948,1,1,1014,898,1097,1056,1246,1424,1453,150,583,982,929,1301,1120,1262,1353,1269,146,862,920,856,1012,1010,1164,1270,1338,130,555,874,869,1165,1013,1098,1144,1165,114,765,775,737,789,737,842,958,842,67,191,604,471,606,501,622,743,561,109,564,1,1,2,416,384,491,465,561,648,597,38,107,486,409,574,553,738,675,699,120,317,1,2,1,1,216,358,392,362,448,515,411,21,105,130,178,242,283,352,418,308,27,189,370,288,376,345,357,423,407,30,178,249,211,406,292,289,343,271,30,196,298,287,274,333,396,427,399,31,100,252,261,334,316,368,350,326,26,161],"Nb Projects":[1125,1035,1052,975,1086,1197,1033,53,241,653,571,730,596,725,770,661,51,542,1442,1359,1265,1133,1156,1057,902,26,187,602,518,705,467,456,407,325,26,483,1,2,1,618,542,576,573,621,721,596,25,609,721,592,814,702,851,887,753,50,669,1,1,762,698,809,802,886,1019,1024,61,444,646,584,788,674,746,801,673,54,592,672,638,700,709,785,895,891,55,333,560,562,674,598,669,661,641,53,501,620,576,607,579,659,735,632,42,145,389,316,421,344,444,470,403,37,362,1,1,2,351,343,410,408,483,526,486,26,92,334,278,390,374,475,465,450,48,248,1,2,1,1,185,327,358,321,408,464,362,15,95,116,146,190,227,287,359,255,17,159,323,253,318,295,319,360,351,24,107,193,159,282,217,231,251,194,26,158,258,237,221,270,328,334,322,27,81,190,191,230,219,276,248,235,19,132],"EU Contribution":[897307238.06,865457055.49,1089083552.11,946674115.39,998089379.2,1174361124.68,718633394.84,63254294.12,0,423996963.8,340928992.02,445562186.49,417957833.98,427744008.19,483012385.33,428523954.75,61040273.44,0,973408818.34,995052469.72,937481281.4,892355179.62,818630913.18,753862969.64,503744939.61,22787626.75,0,288749659.36,288310209.35,338498232.07,224802276.45,192501770.88,180969163.04,162731425.51,32948014.76,0,273287.88,7071222.56,303172.56,420512087.44,372952303.19,410396152.33,448128365.53,462164647.16,546554527.4,349732936.32,22573454.63,0,467355659.11,370625076.34,529589153.72,701258430.58,621477830.26,730210246.7,492331071.74,62594364.53,0,292600,274802.04,419642682.47,401121117.71,459030383.14,452415850.32,524381884.68,663069729.03,570791244.39,52509663.32,0,243720675.37,296323001.48,373839893.75,411600326.18,348053150.55,437663966.6,401475846.15,45344458.85,0,370636266.68,364949126.19,418463158.29,431072439.2,495175474.61,507987653.69,463081639.41,37918304.98,0,253663223.48,249461890.42,348949233.57,386951955.56,306989931.42,383748440.02,313465671.74,38692446.05,0,422887808.43,475113860.59,489522136.15,428129139.74,662815203.24,559925839.18,502303454.5,46243064.14,0,230084744.91,182365327.37,196793324.34,177288348.26,250568565.59,284484752.26,212958056.09,98426657.54,0,624248.24,7128756.25,0,202792895.58,227271597.74,240062692.93,245807073.53,318107994.77,333765539.96,262237736.64,27855431.44,0,125874516.76,112005224.49,138765589.25,144933374.69,205474915.1,286319214.92,394099106.44,55790701.89,0,0,0,0,0,61921872.52,213120366.62,231118311.77,280366956.32,327130771.48,358163455.57,213035578.6,9364094.66,0,1658800.66,15070764.69,25620930.75,77517469.82,103641128.42,189816088.32,136416364.18,5780880.63,0,180394723.3,175020430.51,201622829.03,203905821.7,207404504.94,263242708.87,204969113.52,15204523.63,0,98195482.7,72053702.68,122809152.91,136496497.27,101319458.63,112782092.94,112931802.01,18553215.28,0,132801465.38,147777092.38,141560240.62,156374848.76,177795161.87,226658832.21,161636298.58,12376798.23,0,88258778.7,95057394.66,96651164.7,99934613.24,120129624.27,104040779.56,111553813.61,7740866.95,0]},"columns":[{"accessor":"Country","name":"Country","type":"character"},{"accessor":"Call Year","name":"Call Year","type":"numeric"},{"accessor":"Type","name":"Type","type":"factor"},{"accessor":"Participation Count","name":"Participation Count","type":"numeric","aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}}},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}}},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","aggregate":"sum","format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}}}],"pivotBy":["Country","Call Year"],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"compact":true,"dataKey":"27e39e673fae18eccf3211726b34e9bf","key":"27e39e673fae18eccf3211726b34e9bf"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Switzerland ranks 8th by total EU contribution in H2020 (the CERN is
not taken into account, see <a href="#cern">Annex: CERN</a>).</p>
<pre class="r"><code># minimal plotting
pal &lt;- c(
  rep(&quot;gray75&quot;, ch_rank - 1),
  &quot;firebrick4&quot;,
  rep(&quot;gray75&quot;, 10 - ch_rank)) %&gt;%
  rev()

top_participants %&gt;%
  mutate(Country = fct_rev(fct_inorder(Country)),
         share = 100 * prop.table(contrib_country)) %&gt;%
  head(10) %&gt;%
  ggplot(aes(x = contrib_country, y = Country, fill = Country)) +
  geom_col() +
  geom_text(
    aes(label = sprintf(&quot;%.1f%%&quot;, share)),
    hjust = 1.15,
    size = 4,
    fontface = &quot;bold&quot;,
    family = &quot;Gill Sans&quot;
  ) +
  labs(x = NULL, y = NULL) +
  scale_fill_manual(values = pal, guide = &quot;none&quot;) +
  theme_void() +
  theme(
    plot.margin = margin(c(4, 2, 4, 8)),
    axis.text.y = element_text(
      margin = margin(t = 0, r = -10, b = 0, l = 5),
      size = 14,
      family = &quot;Gill Sans&quot;,
      hjust = 1,
      color = &quot;gray10&quot;
    )
  )</code></pre>
<p><img src="index_files/figure-html/visual-countries-1.png" width="672" /></p>
</div>
<div id="swiss-participation-an-overview" class="section level2">
<h2>Swiss Participation: An Overview</h2>
<pre class="r"><code>get_participation &lt;- function(x) {
  x %&gt;%
    filter(!is.na(pillar)) %&gt;%
    mutate(pillar = fct_rev(pillar)) %&gt;%
    group_by(Pillar = pillar,
             Priority = thematic_priority_abbr,
             `Call Year` = call_year) %&gt;%
    summarise(
      `Participation Count` = n(),
      `Nb Projects` = n_distinct(project_id),
      `EU Contribution` = sum(eu_contribution, na.rm = TRUE)
    ) %&gt;%
    ungroup() %&gt;%
    mutate(`EU Contribution` = round(`EU Contribution`, 1)) %&gt;%
    reactable(
      groupBy = c(&quot;Pillar&quot;, &quot;Priority&quot;),
      columns = list(
        Pillar = colDef(footer = &quot;Total&quot;),
        `Participation Count` = colDef(
          aggregate = &quot;sum&quot;,
          format = colFormat(separators = TRUE),
          footer = function(values)
            sum(values) %&gt;% format(big.mark = &quot;,&quot;)
        ),
        `Nb Projects` = colDef(
          aggregate = &quot;sum&quot;,
          format = colFormat(separators = TRUE),
          footer = function(values)
            sum(values) %&gt;% format(big.mark = &quot;,&quot;)
        ),
        `EU Contribution` = colDef(
          aggregate = &quot;sum&quot;,
          format = colFormat(
            currency = &quot;EUR&quot;,
            separators = TRUE,
            digits = 2
          ),
          footer = function(values)
            sum(values) %&gt;% format(big.mark = &quot;,&quot;) %&gt;% str_c(&quot;€&quot;, .)
        )
      ),
      defaultColDef = colDef(footerStyle = list(fontWeight = &quot;bold&quot;)),
      highlight = TRUE,
      compact = TRUE
    )
}</code></pre>
<p>Swiss participation in H2020: participation count, number of projects
(distinct), total EU contribution by pillar, thematic priority, and call
year.</p>
<pre class="r"><code>df %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  get_participation()</code></pre>
<div id="htmlwidget-105fd1dfd8550ebf76c4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-105fd1dfd8550ebf76c4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Pillar":["I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","IV","IV","IV","IV","IV","IV","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","Euratom","Euratom","Euratom","Euratom","Cross-theme","Cross-theme","Cross-theme","Cross-theme"],"Priority":["ERC","ERC","ERC","ERC","ERC","ERC","ERC","FET","FET","FET","FET","FET","FET","FET","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","INNOSUPSME","INNOSUPSME","INNOSUPSME","INNOSUPSME","INNOSUPSME","LEIT","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","RISKFINANCE","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SOCCHAL-CROSST","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","TPT","TPT","TPT","TPT","TPT","TPT","TPT","TPT","TWINING","TWINING","TWINING","TWINING","WIDESPREAD","WIDESPREAD","CAREER","CAREER","CAREER","CAREER","CAREER","GENDEREQ","GOV","GOV","GOV","GOV","INEGSOC","INEGSOC","INEGSOC","INEGSOC","INEGSOC","RESACCESS","SCIENCE","SWAFS-CROSST","SWAFS-CROSST","EURATOM","EURATOM","EURATOM","EURATOM","CROSST","CROSST","CROSST","CROSST"],"Call Year":[2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2014,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2020,2014,2015,2016,2017,2018,2019,2020,2014,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2021,2015,2017,2018,2019,2016,2018,2014,2017,2018,2019,2020,2014,2014,2015,2017,2018,2014,2015,2017,2019,2020,2018,2018,2018,2020,2014,2016,2018,2019,2016,2018,2019,2020],"Participation Count":[26,128,98,91,98,104,42,19,5,23,55,56,89,72,28,13,30,22,26,22,32,5,5,115,121,114,145,185,186,3,4,88,105,17,1,11,19,15,26,16,15,20,2,3,16,16,16,15,12,3,2,4,4,11,1,58,64,86,52,67,88,79,14,4,5,15,5,14,10,5,10,11,9,10,1,21,46,49,52,60,50,35,5,24,14,18,28,31,19,22,11,18,19,29,40,24,48,42,6,36,56,54,52,81,71,77,19,5,14,11,14,8,15,12,5,12,3,8,4,8,8,6,23,14,43,39,32,54,32,1,5,2,2,7,3,2,1,2,1,2,2,2,3,1,1,2,2,1,2,2,2,2,1,1,5,15,15,8,13,1,3,11,4],"Nb Projects":[25,120,93,87,95,101,42,16,3,17,29,41,45,44,22,10,21,12,20,20,21,2,5,105,110,108,127,168,166,1,1,86,104,17,1,9,10,9,15,11,10,14,2,2,12,10,9,11,10,2,2,4,4,7,1,49,52,57,38,44,54,56,7,3,2,12,4,14,5,5,10,9,8,8,1,18,26,26,37,31,36,25,5,19,10,13,19,23,15,18,9,13,14,22,29,16,32,26,2,25,33,34,34,43,51,47,7,4,8,8,12,7,10,11,5,11,3,7,4,8,7,6,15,14,37,28,25,40,26,1,5,2,2,7,3,2,1,2,1,1,2,2,2,1,1,1,2,1,2,1,1,1,1,1,4,11,11,7,11,1,2,9,4],"EU Contribution":[50509172.7,182992449,143129828.9,167078380.2,169866156,175384316.8,46931831.6,4982391,2509438.5,14043460.6,36050009.5,31338879.6,57207903.4,52715698.2,360000,7306278.9,10406420.7,8161028.6,13637620.5,6591396.3,10767917.6,2637181.2,4294792.8,30545144.5,34465635.7,33009112.7,41763785,56514099.4,50624940.6,171759,402131.5,15739361.3,55554181.9,28736010.8,118125,17500,0,0,11701802.5,9337677.5,8686107.2,12761375,0,0,0,4798904.5,4576819,7088351.9,4862318.4,0,0,59812.5,974875,3718840.3,471250,390509.2,641357.8,3393373.4,18339609.1,29632533.9,43372483.2,34262655.5,24375,543375,0,4540803.8,2589794.3,730625,0,69785.6,2013946.2,3883022.5,2575311,2896598.8,0,0,538802.9,478566.2,18282576.5,30988470,19347288.5,14636855.2,2411821.2,851030.2,0,1796555,8345267.1,11186437.2,11012720.2,6479491.4,3848875,32637.5,1217864.4,2247128.8,9742398.3,6559053.3,18628320.6,17441474.4,2598908.1,71245.6,810906,2356130.1,11135617.6,33901116.6,51995380,35078196.7,2554439.7,120250,0,2157071.1,6770027,2926429.4,4820571.9,5796444.9,9022139.8,0,0,48937.5,1263502.5,1869528.5,1821018.8,1617738.8,199096.9,0,5503008.4,14263400.7,11164498.2,14593741.9,9052921.4,975625,1085514.2,420816.2,343387.5,1145951.2,160093.8,2826077.5,0,221850,49000,36852.5,127250,37512.5,0,0,37390.5,503277.5,0,0,330975.9,728730,667885,371180,185875,33725,554708.8,787775.9,35816776.3,3471249.6,3042148.2,606658,897898.9,7361418.9,1827695.6]},"columns":[{"accessor":"Pillar","name":"Pillar","type":"factor","footerStyle":{"fontWeight":"bold"},"footer":"Total"},{"accessor":"Priority","name":"Priority","type":"character","footerStyle":{"fontWeight":"bold"}},{"accessor":"Call Year","name":"Call Year","type":"numeric","footerStyle":{"fontWeight":"bold"}},{"accessor":"Participation Count","name":"Participation Count","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"4,661"},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"3,637"},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}},"footer":"€2,249,743,835"}],"pivotBy":["Pillar","Priority"],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"compact":true,"dataKey":"c4c17e86ffcdc934b58a66a39d7de9e4","key":"c4c17e86ffcdc934b58a66a39d7de9e4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># Differentiate pillars 1 to III
stats_depth_1 &lt;- df %&gt;%
  filter(!is.na(pillar)) %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(!pillar %in% chr(roman(1:3))) %&gt;%
  mutate(pillar = fct_rev(pillar)) %&gt;%
  group_by(pillar, pillar_descr) %&gt;%
  summarise(total_eu_contrib = sum(eu_contribution)) %&gt;%
  ungroup() %&gt;%
  # for printing
  mutate(pillar_descr = ifelse(
    chr(pillar) %in% chr(roman(4:5)),
    str_c(pillar, &quot;. &quot;, pillar_descr),
    chr(pillar)),
    thematic_priority_abbr = NA) %&gt;%
  # for binding
  select(pillar = pillar_descr,
         thematic_priority = thematic_priority_abbr,
         contrib = total_eu_contrib)

stats_depth_2 &lt;- df %&gt;%
  filter(!is.na(pillar)) %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(pillar %in% chr(roman(1:3))) %&gt;%
  mutate(pillar = fct_rev(pillar)) %&gt;%
  group_by(pillar, pillar_descr, thematic_priority_abbr) %&gt;%
  summarise(total_eu_contrib = sum(eu_contribution)) %&gt;%
  ungroup() %&gt;%
  # for printing
  unite(&quot;pillar&quot;, starts_with(&quot;pillar&quot;), sep = &quot;. &quot;) %&gt;%
  # for binding
  select(pillar,
         thematic_priority = thematic_priority_abbr,
         contrib = total_eu_contrib)

stats_depth_2 %&gt;%
bind_rows(stats_depth_1) %&gt;%
  mutate(
    thematic_priority = replace_na(thematic_priority, &quot;&quot;),
    contrib_txt = contrib / 1000000,
    contrib_txt = format(
      contrib_txt,
      big.mark = &quot;,&quot;,
      decimal.mark = &quot;.&quot;,
      trim = TRUE,
      digits = 2),
    contrib_txt = str_c(&quot;M€&quot;, contrib_txt)) %&gt;%
  write_csv(here(&quot;data&quot;, &quot;h2020-treemap.csv&quot;))
# plot with https://rawgraphs.io</code></pre>
<p>Treemap showing the overall H2020 EU contribution (MEUR) to
Switzerland by Pillar and Thematic Priority. Only the three largest
pillars are shown.</p>
<p><img
src="https://raw.githubusercontent.com/zambujo/swissparticipation/main/data/treemap-ch.svg"
title="H2020 EU contribution to Swiss participants, by pillar and thematic priority." /></p>
<div id="swiss-participation-by-sector" class="section level3">
<h3>Swiss Participation by Sector</h3>
<pre class="r"><code>pal &lt;- c(&quot;firebrick4&quot;, &quot;gray65&quot;) %&gt;%
  rev()

df %&gt;%
  filter(!is.na(pillar)) %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  mutate(pillar = fct_other(pillar, keep = chr(roman(1:5))),
         pillar = fct_relevel(pillar, &quot;Other&quot;, after = 0)) %&gt;%
  group_by(pillar, org_type, role = partner_role) %&gt;%
  summarise(contrib = sum(eu_contribution, na.rm = TRUE)) %&gt;%
  ungroup() %&gt;%
  mutate(org_type = fct_rev(org_type)) %&gt;%
  arrange(pillar, org_type) %&gt;%
  ggplot(aes(x = pillar, y = contrib, fill = org_type)) +
  geom_col(position = position_stack(reverse = FALSE)) +
  scale_fill_manual(values = pal, guide = guide_legend(reverse = TRUE)) +
  # scale_fill_nejm(alpha = .5, guide = guide_legend(reverse = TRUE)) +
  scale_y_continuous(labels = unit_format(
    suffix = &quot;&quot;,
    scale = 1e-6,
    big.mark = &quot;,&quot;
  )) +
  coord_flip() +
  facet_wrap(role ~ ., ncol = 1) +
  theme_minimal() +
  labs(
    title = &quot;Distribution of EU Contribution to Swiss Institutions&quot;,
    subtitle = &quot;By Pillar,Institution Type, and Instituion Role&quot;,
    x = &quot;Pillar&quot;,
    y = &quot;EU Contribution to Swiss Institutions (MioEUR)&quot;
  ) +
  theme(
    text = element_text(size = 15, family = &quot;Gill Sans&quot;, color = &quot;gray10&quot;),
    plot.title.position = &quot;plot&quot;,
    legend.position = &quot;top&quot;,
    legend.title = element_blank(),
    axis.title.y = element_text(angle = 0, vjust = 1.05, margin = margin(r = -30))
  )</code></pre>
<p><img src="index_files/figure-html/ch-type-role-1.png" width="672" /></p>
<div id="eu-contribution-to-swiss-institutions-in-research-and-highered"
class="section level4">
<h4>EU Contribution to Swiss Institutions in Research and HigherEd</h4>
<pre class="r"><code>df %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(org_type == &quot;Research &amp; Education&quot;) %&gt;%
  get_participation()</code></pre>
<div id="htmlwidget-293072bc07c1ce33a29f" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-293072bc07c1ce33a29f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Pillar":["I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","II","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","III","IV","IV","IV","IV","IV","IV","V","V","V","V","V","V","V","V","V","V","V","V","V","Euratom","Euratom","Euratom","Euratom","Cross-theme","Cross-theme"],"Priority":["ERC","ERC","ERC","ERC","ERC","ERC","ERC","FET","FET","FET","FET","FET","FET","FET","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","INNOSUPSME","INNOSUPSME","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMANU","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-ADVMAT","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-BIOTECH","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-NMP","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","LEIT-SPACE","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENERGY","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","FOOD","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","HEALTH","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SECURITY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","SOCIETY","TPT","TPT","TPT","TPT","TPT","TPT","TPT","TWINING","TWINING","TWINING","TWINING","WIDESPREAD","WIDESPREAD","CAREER","CAREER","CAREER","CAREER","GENDEREQ","GOV","INEGSOC","INEGSOC","INEGSOC","INEGSOC","INEGSOC","RESACCESS","SWAFS-CROSST","EURATOM","EURATOM","EURATOM","EURATOM","CROSST","CROSST"],"Call Year":[2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2014,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2018,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2021,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2015,2017,2018,2019,2016,2018,2014,2017,2018,2020,2014,2018,2014,2015,2017,2019,2020,2018,2020,2014,2016,2018,2019,2019,2020],"Participation Count":[26,120,95,88,95,102,40,17,5,16,41,39,53,49,23,11,23,14,17,18,22,4,2,97,101,89,118,152,143,2,1,7,6,8,8,5,7,8,1,2,8,6,7,5,3,2,1,1,4,25,32,40,20,26,37,39,7,2,3,6,3,8,5,2,2,6,5,6,6,17,24,20,27,23,15,2,16,9,7,14,23,10,15,7,11,4,14,13,13,19,21,2,24,28,19,21,31,31,23,6,4,7,6,4,3,3,5,8,3,7,3,6,5,3,12,4,4,8,13,20,8,4,2,2,6,2,2,1,2,1,1,2,2,1,1,1,2,1,1,3,11,12,7,13,4,2],"Nb Projects":[25,114,90,85,92,100,40,15,3,13,27,35,37,31,19,10,16,8,15,16,16,2,2,91,98,89,110,142,137,1,1,7,6,8,7,5,7,8,1,1,8,5,6,5,3,2,1,1,4,23,30,36,18,26,31,33,4,2,2,5,3,8,4,2,2,6,4,6,6,14,17,16,21,21,14,2,13,8,7,10,17,8,13,5,9,4,13,13,11,17,16,1,17,22,18,19,25,29,19,5,4,5,6,2,3,3,5,7,3,6,3,6,5,3,9,4,4,7,12,17,7,4,2,2,6,2,2,1,2,1,1,2,1,1,1,1,1,1,1,3,9,11,7,11,4,2],"EU Contribution":[50509172.7,175619584.6,141331713.4,163889681.5,169491156,169877316.8,44782321.6,4393681,2509438.5,9971636.1,30299964.7,22263565.7,42876537.5,41433543,360000,6919091.4,7979858.4,7198871.1,11949585.7,5754611.3,7267037.1,2597181.2,3928853.5,25708037.9,30626152.4,23925675.1,34893265.4,49268020.1,40324723.1,171759,0,17500,0,0,5253315.8,6058733.8,5211375,6079806.2,0,0,0,2475493.8,2694203,3212753.8,1118218.8,0,0,0,1959490.5,0,352995.8,909420.2,8698600.8,12939111.6,22645383.2,19686762.7,24375,0,0,3329112.5,1676400.5,649412.5,0,0,449650,2426028,1681238.8,1975848.8,0,414048.1,210438.8,7970786.6,17393560.1,10673591.2,7407042.2,1106875,851030.2,0,646080,4303698.1,9609432.2,2684695.2,4861967.9,2481602.5,31437.5,0,1359228.8,5619726.5,3599844.9,7911995.4,12128558.2,966941.2,71245.6,787156,1887405.1,8629225.5,18160626.6,19610661.9,15643694.1,2211494.7,120250,0,791783.6,2260627.3,1022292.8,1719277.9,2214908.8,0,0,48937.5,1133877.5,1531842.2,1203906.3,972951.3,40000,0,0,4109507.3,4220705.8,7088146.8,3612706.1,810014.2,420816.2,343387.5,889930,113718.8,2826077.5,0,221850,49000,102500,37512.5,503277.5,0,0,176475.9,728730,444328.8,286655,317953.8,715643,35241938.8,2908929.5,3042148.2,2083136.2,984305.6]},"columns":[{"accessor":"Pillar","name":"Pillar","type":"factor","footerStyle":{"fontWeight":"bold"},"footer":"Total"},{"accessor":"Priority","name":"Priority","type":"character","footerStyle":{"fontWeight":"bold"}},{"accessor":"Call Year","name":"Call Year","type":"numeric","footerStyle":{"fontWeight":"bold"}},{"accessor":"Participation Count","name":"Participation Count","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"2,723"},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"2,440"},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}},"footer":"€1,694,221,407"}],"pivotBy":["Pillar","Priority"],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"compact":true,"dataKey":"55ce42c10354b150213a41d63cf03550","key":"55ce42c10354b150213a41d63cf03550"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<hr />
</div>
</div>
</div>
<div id="annex" class="section level2">
<h2>Annex</h2>
<div id="typology-of-the-top-10-participating-countries"
class="section level3">
<h3>Typology of the Top-10 Participating Countries</h3>
<pre class="r"><code>pal &lt;- c(
  rep(&quot;gray45&quot;, ch_rank - 1),
  &quot;firebrick4&quot;,
  rep(&quot;gray45&quot;, 10 - ch_rank)) %&gt;%
  rev()

## share to Pillar I
contribution_share_pillar &lt;- df %&gt;%
  filter(!is.na(pillar)) %&gt;%
  # excluding Switzerland in 2014
  filter(country_code != &quot;CH&quot; | call_year != 2014) %&gt;%
  semi_join(top_participants %&gt;%
              select(country = Country) %&gt;%
              head(10),
            by = &quot;country&quot;) %&gt;%
  group_by(
    Country = country,
    Pillar = pillar) %&gt;%
  summarise(`Contribution` = sum(eu_contribution)) %&gt;%
  mutate(share_pillar = 100 * prop.table(Contribution)) %&gt;%
  filter(Pillar == &quot;I&quot;) %&gt;%
  select(-Pillar, -Contribution)

## share to Resesearch and HigherEd
contribution_share_reshed &lt;- df %&gt;%
  filter(!is.na(pillar)) %&gt;%
  # excluding Switzerland in 2014
  filter(country_code != &quot;CH&quot; | call_year != 2014) %&gt;%
  semi_join(top_participants %&gt;%
              select(country = Country) %&gt;%
              head(10),
            by = &quot;country&quot;) %&gt;%
  group_by(
    Country = country,
    Type = org_type) %&gt;%
  summarise(`Contribution` = sum(eu_contribution)) %&gt;%
  mutate(share_reshed = 100 * prop.table(Contribution)) %&gt;%
  filter(Type == &quot;Research &amp; Education&quot;) %&gt;%
  select(-Type, -Contribution)

top_participants %&gt;%
  inner_join(contribution_share_reshed, by = c(&quot;Country&quot;)) %&gt;%
  inner_join(contribution_share_pillar, by = c(&quot;Country&quot;)) %&gt;%
  mutate(Country = fct_rev(fct_inorder(Country)),
         contrib_country = contrib_country / 1000000) %&gt;%
  ggplot(
    aes(
      x = share_pillar,
      y = share_reshed,
      label = Country,
      col = Country,
      size = contrib_country
    )
  ) +
  geom_point(fill = NA) +
  geom_text_repel(
    size = 5,
    show.legend = FALSE,
    box.padding = .75,
    family = &quot;Gill Sans&quot;
  ) +
  guides(size = guide_legend(
    title = &quot;Total EU Contribution (MioEUR) :&quot;,
    override.aes = list(fill = &quot;gray45&quot;, col = &quot;gray45&quot;, shape = 21))) +
  labs(
    x = &quot;Contributions to Pillar I: Excellent Science (%)&quot;,
    y = &quot;Contribution to Institutions in Research and HigherEd (%)&quot;
    ) +
  scale_color_manual(values = pal, guide = &quot;none&quot;) +
  theme_minimal() +
  theme(
    text = element_text(size = 16, family = &quot;Gill Sans&quot;, color = &quot;gray10&quot;),
    plot.title.position = &quot;plot&quot;,
    legend.position = &quot;top&quot;
  )</code></pre>
<p><img src="index_files/figure-html/additional-context-1.png" width="672" /></p>
</div>
<div id="time-distribution-of-the-contribution-to-research-highered"
class="section level3">
<h3>Time Distribution of the Contribution to Research &amp;
HigherEd</h3>
<pre class="r"><code>pal &lt;- c(&quot;firebrick4&quot;, &quot;gray55&quot;) %&gt;%
  col2hcl()

ch_res &lt;- df %&gt;%
  filter(!is.na(call_deadline_date)) %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(org_type == &quot;Research &amp; Education&quot;) %&gt;%
  mutate(call_semester = floor_date(call_deadline_date, &quot;6 months&quot;)) %&gt;%
  group_by(Country = country, Semester = call_semester) %&gt;%
  summarise(contrib = sum(eu_contribution, na.rm = TRUE)) %&gt;%
  mutate(Share = 100 * prop.table(contrib)) %&gt;%
  select(-contrib)

rest &lt;- df %&gt;%
  filter(!is.na(call_deadline_date)) %&gt;%
  filter(!country_code %in% c(&quot;CH&quot;)) %&gt;%
  filter(org_type == &quot;Research &amp; Education&quot;) %&gt;%
  mutate(call_semester = floor_date(call_deadline_date, &quot;6 months&quot;)) %&gt;%
  group_by(Semester = call_semester) %&gt;%
  summarise(contrib = sum(eu_contribution)) %&gt;%
  mutate(Share = 100 * prop.table(contrib)) %&gt;%
  select(-contrib) %&gt;%
  mutate(Country = &quot;Remaining&quot;) %&gt;%
  relocate(Country)

ch_res %&gt;%
  bind_rows(rest) %&gt;%
  mutate(Country = factor(
    Country,
    levels = c(&quot;Switzerland&quot;, &quot;Remaining&quot;))) %&gt;%
  ggplot(aes(x = Semester, y = Share, fill = Country, col = Country)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + 
  labs(
    title = &quot;EU Contribution to Research and HigherEd: Time Distribution&quot;,
    subtitle = glue(
      &quot;&lt;span style=&#39;color:{pal[1]};&#39;&gt;Switzerland&lt;/span&gt; &quot;,
      &quot;versus &lt;span style=&#39;color:{pal[2]};&#39;&gt;Remaining Countries&lt;/span&gt;&quot;),
    x = &quot;Call Semester&quot;,
    y = &quot;%&quot;
  ) +
  scale_color_manual(values = c(&quot;white&quot;, &quot;white&quot;), guide = &quot;none&quot;) +
  scale_fill_manual(values = pal, guide = &quot;none&quot;) +
  theme_minimal() +
  theme(
    plot.title.position = &quot;plot&quot;,
    plot.subtitle = element_markdown(),
    text = element_text(
      size = 13,
      family = &quot;Gill Sans&quot;,
      color = &quot;gray10&quot;
    )
  )</code></pre>
<p><img src="index_files/figure-html/time-distribution-1.png" width="672" /></p>
</div>
<div id="top-recipients-in-switzerland" class="section level3">
<h3>Top Recipients in Switzerland</h3>
<div id="top-30-in-research-and-higher-education"
class="section level4">
<h4>Top 30 in Research and Higher Education</h4>
<pre class="r"><code>df %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(org_type == &quot;Research &amp; Education&quot;) %&gt;%
  group_by(Institution = legal_name) %&gt;%
  summarise(
    `Nb Projects` = n_distinct(project_id),
    `EU Contribution` = sum(eu_contribution, na.rm = TRUE)
  ) %&gt;%
  arrange(desc(`EU Contribution`)) %&gt;%
  mutate(Institution = str_to_title(Institution)) %&gt;%
  slice_head(n = 30) %&gt;%
  reactable(
    columns = list(
      `Nb Projects` = colDef(sortable = TRUE),
      `EU Contribution` = colDef(
        sortable = TRUE,
        format = colFormat(
          currency = &quot;EUR&quot;,
          separators = TRUE,
          digits = 2
        )
      )
    ),
    highlight = TRUE,
    searchable = TRUE,
    sortable = FALSE,
    showSortable = TRUE,
    compact = TRUE,
    minRows = 10
  )</code></pre>
<div id="htmlwidget-b410a505994a25a28b5d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b410a505994a25a28b5d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Institution":["Eidgenoessische Technische Hochschule Zuerich","Ecole Polytechnique Federale De Lausanne","Universitat Zurich","Universite De Geneve","Universitaet Bern","Universitat Basel","Universite De Lausanne","Friedrich Miescher Institute For Biomedical Research Fondation","Paul Scherrer Institut","Csem Centre Suisse D'electronique Et De Microtechnique Sa - Recherche Et Developpement","Eidgenossische Materialprufungs- Und Forschungsanstalt","Scuola Universitaria Professionale Della Svizzera Italiana","Universite De Fribourg","Universita Della Svizzera Italiana","Haute Ecole Specialisee De Suisse Occidentale","Zurcher Hochschule Fur Angewandte Wissenschaften","Schweizerisches Tropen- Und Public Health-Institut","Universite De Neuchatel","Forschungsinstitut Fur Biologischen Landbau Stiftung","Eidgenossische Forschungsanstalt Wsl","Fondation Pour L Institut De Hautes Etudes Internationales Et Du Developpement","Fondazione Per L'istituto Di Ricerca In Biomedicina","Fachhochschule Nordwestschweiz","Sib Swiss Institute Of Bioinformatics","Schweizerischer Nationalfonds Zur Forderung Der Wissenschaftlichen Forschung","Fondation De L'institut De Recherche Idiap","Ao-Forschungsinstitut Davos","Fondazione Per L'istituto Oncologico Di Ricerca (Ior)","Berner Fachhochschule","Ost - Ostschweizer Fachhochschule"],"Nb Projects":[591,480,231,198,175,153,102,44,93,87,89,56,29,22,42,41,22,24,32,25,10,9,30,23,19,20,13,2,16,7],"EU Contribution":[427423303,355574588.47,159426572.53,114258351.22,98798291.92,77825231.1,59954286.04,48626032.27,45878965.48,41790319.47,32494698.28,22276840.37,20738957.22,15530792.87,14107990.56,13181357.38,12256653.31,11659102.16,10863513.25,10411436.91,9867861.88,9644449.2,9089829.58,8907992.33,7264338.24,6405764.76,5957383.59,3940000,3744779.14,3529733.75]},"columns":[{"accessor":"Institution","name":"Institution","type":"character"},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","sortable":true},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","sortable":true,"format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}}}],"sortable":false,"searchable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":10,"highlight":true,"compact":true,"showSortable":true,"dataKey":"dccab11778d50fcdf841880f93ea0283","key":"dccab11778d50fcdf841880f93ea0283"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="top-30-not-in-research-and-higher-education"
class="section level4">
<h4>Top 30 not in Research and Higher Education</h4>
<pre class="r"><code>df %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  # remove international organisations
  filter(org_type == &quot;Others (Excl. R&amp;Ed)&quot;) %&gt;%
  group_by(Institution = legal_name) %&gt;%
  summarise(
    `Nb Projects` = n_distinct(project_id),
    `EU Contribution` = sum(eu_contribution, na.rm = TRUE)
  ) %&gt;%
  arrange(desc(`EU Contribution`)) %&gt;%
  mutate(Institution = str_to_title(Institution)) %&gt;%
  slice_head(n = 30) %&gt;%
  reactable(
    columns = list(
      `Nb Projects` = colDef(sortable = TRUE),
      `EU Contribution` = colDef(
        sortable = TRUE,
        format = colFormat(
          currency = &quot;EUR&quot;,
          separators = TRUE,
          digits = 2
        )
      )
    ),
    highlight = TRUE,
    searchable = TRUE,
    sortable = FALSE,
    showSortable = TRUE,
    compact = TRUE,
    minRows = 10
  )</code></pre>
<div id="htmlwidget-7a38a991c44d6b6ffaad" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7a38a991c44d6b6ffaad">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Institution":["Ibm Research Gmbh","Centre Hospitalier Universitaire Vaudois","Fondation Innovative Medicines For Tuberculosis (Im4tb)","Eidgenoessisches Departement Fuer Wirtschaft, Bildung Und Forschung","Martel Gmbh","Sphynx Technology Solutions Ag","Organisation Meteorologique Mondiale","Skyguide, Sa Suisse Pour Les Services De La Navigation Aerienne Civils Et Militaires","Bioversys Ag","Alpes Lasers Sa","Quantis","Ligentec Sa","Eidgenoessische Anstalt Fuer Wasserversorgung Abwasserreinigung Und Gewaesserschutz","European Respiratory Society","Stiftung Swiss School Of Public Health Plus (Ssph)","Accelopment Schweiz Ag","Solidpower Sa","Eidgenoessisches Departement Des Innern","Ava Ag","Avantama Ag","Insolight Sa","Id Quantique Sa","Tvp Solar Sa","Fpt Motorenforschung Ag","Cutiss Ag","Ava Biochem Bsl Ag","Scientific Visual Sa","Brusa Elektronik Ag","Maxivax Sa","Association Compaz"],"Nb Projects":[117,43,1,38,36,21,9,23,2,12,30,8,25,12,2,24,13,18,1,5,2,8,2,6,4,10,4,3,1,3],"EU Contribution":[47323247.4,22883196.5,22407250,14071255.62,8576838.09,8521590.4,8470000,7141658.17,7079101.76,6392588.5,5535624.75,5043237.32,4972416.87,4921455.83,4578000,4200933.13,4170769.37,4013205.3,3774250,3452863.13,3436954,3229019.98,3143090.13,3139584.21,3014267.89,2983474.25,2899373.88,2831339.5,2785300,2773935.29]},"columns":[{"accessor":"Institution","name":"Institution","type":"character"},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","sortable":true},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","sortable":true,"format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}}}],"sortable":false,"searchable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":10,"highlight":true,"compact":true,"showSortable":true,"dataKey":"8e4fcecd84f4f2533daef4cb88b177d2","key":"8e4fcecd84f4f2533daef4cb88b177d2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="cern" class="section level3">
<h3>CERN</h3>
<pre class="r"><code>total_cern &lt;- df_raw %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(legal_name == &quot;EUROPEAN ORGANIZATION FOR NUCLEAR RESEARCH&quot;) %&gt;%
  summarise(total_eu_contrib = sum(eu_contribution, na.rm = TRUE)) %&gt;%
  pull() %&gt;%
  format(big.mark = &quot;,&quot;, decimal.mark = &quot;.&quot;, trim = TRUE, digits = 11)</code></pre>
<p><strong>Note</strong>: EU Contribution to Switzerland include
€117,572,425.46 awarded to the CERN. Please find the EU contribution to
CERN in detail below:</p>
<pre class="r"><code>df_raw %&gt;%
  filter(country_code == &quot;CH&quot;) %&gt;%
  filter(legal_name == &quot;EUROPEAN ORGANIZATION FOR NUCLEAR RESEARCH&quot;) %&gt;%
  get_participation()</code></pre>
<div id="htmlwidget-d209c6289d8d6cc4d995" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d209c6289d8d6cc4d995">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Pillar":["I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","I","II","II","II","II","II","IV","V","V","Euratom","Euratom","Euratom"],"Priority":["ERC","ERC","ERC","ERC","ERC","ERC","FET","FET","FET","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","INFRA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","MSCA","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-ICT","LEIT-SPACE","TWINING","CAREER","INEGSOC","EURATOM","EURATOM","EURATOM"],"Call Year":[2014,2015,2017,2018,2019,2020,2016,2017,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2017,2018,2019,2020,2014,2015,2016,2018,2018,2015,2014,2019,2014,2018,2019],"Participation Count":[4,2,4,1,2,1,1,1,1,10,2,5,8,4,4,10,9,7,5,4,2,5,3,1,1,1,1,1,1,1,1,1,2,2],"Nb Projects":[4,2,4,1,2,1,1,1,1,10,2,5,8,4,4,10,9,7,5,4,2,5,3,1,1,1,1,1,1,1,1,1,2,2],"EU Contribution":[3744926.2,1613750,3554375,368750,1381250,150000,380082.5,35000,243375,6094165.6,4645672.9,2701154,20818782,2678415,2604692.5,40916813.3,8371939.1,2078668.9,1602992.2,1248326.6,273949.4,1090090.5,546026.1,186500,4360926,374550.3,3801554.1,595633.8,144277.5,170625,293750,105938,112099,283375]},"columns":[{"accessor":"Pillar","name":"Pillar","type":"factor","footerStyle":{"fontWeight":"bold"},"footer":"Total"},{"accessor":"Priority","name":"Priority","type":"character","footerStyle":{"fontWeight":"bold"}},{"accessor":"Call Year","name":"Call Year","type":"numeric","footerStyle":{"fontWeight":"bold"}},{"accessor":"Participation Count","name":"Participation Count","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"108"},{"accessor":"Nb Projects","name":"Nb Projects","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":"108"},{"accessor":"EU Contribution","name":"EU Contribution","type":"numeric","footerStyle":{"fontWeight":"bold"},"aggregate":"sum","format":{"cell":{"digits":2,"separators":true,"currency":"EUR"},"aggregated":{"digits":2,"separators":true,"currency":"EUR"}},"footer":"€117,572,426"}],"pivotBy":["Pillar","Priority"],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"compact":true,"dataKey":"e01ff9aea4e35bbda434eec5e34d9e45","key":"e01ff9aea4e35bbda434eec5e34d9e45"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="raw-data" class="section level3">
<h3>Raw Data</h3>
<p>The raw data set contains 171,768 rows with the following
attributes:</p>
<pre class="r"><code>df_raw %&gt;%
  sample_n(100) %&gt;%
  glimpse()</code></pre>
<pre><code>## Rows: 100
## Columns: 33
## $ project_id             &lt;dbl&gt; 101004709, 607691, 643381, 820869, 296448, 1010…
## $ project_acronym        &lt;chr&gt; &quot;EiA&quot;, &quot;SLANDAIL&quot;, &quot;TBVAC2020&quot;, &quot;REACT&quot;, &quot;DOPA&quot;…
## $ pic                    &lt;dbl&gt; 916274126, 998058415, 986454887, 907448872, 962…
## $ legal_name             &lt;chr&gt; &quot;STEINBEIS 2I GMBH&quot;, &quot;Police Service of Norther…
## $ legal_short_name       &lt;chr&gt; &quot;Steinbeis 2i GmbH&quot;, &quot;PSNI&quot;, &quot;DH&quot;, &quot;Soft Chemic…
## $ legal_entity_type      &lt;chr&gt; &quot;PRC&quot;, &quot;PUB&quot;, &quot;REC&quot;, &quot;PRC&quot;, &quot;PRC&quot;, &quot;REC&quot;, &quot;PRC&quot;…
## $ country_code           &lt;chr&gt; &quot;DE&quot;, &quot;UK&quot;, &quot;UK&quot;, &quot;IT&quot;, &quot;FR&quot;, &quot;ES&quot;, &quot;ES&quot;, &quot;IT&quot;,…
## $ legal_url              &lt;chr&gt; &quot;www.steinbeis-europa.de&quot;, &quot;http://www.psni.pol…
## $ partner_role           &lt;chr&gt; &quot;Coordinator&quot;, &quot;Participant&quot;, &quot;Participant&quot;, &quot;P…
## $ ec_contribution        &lt;dbl&gt; 759875, 48000, 141615084, 561900, 432670, 16093…
## $ net_ec_contribution    &lt;dbl&gt; 759875, 48000, 141615084, 506900, 432670, 16093…
## $ pillar_abbr            &lt;chr&gt; &quot;EU.3.&quot;, NA, &quot;EU.3.&quot;, &quot;EU.3.&quot;, NA, &quot;EU.1.&quot;, NA,…
## $ pillar_descr           &lt;chr&gt; &quot;Societal Challenges&quot;, NA, &quot;Societal Challenges…
## $ thematic_priority_abbr &lt;chr&gt; &quot;SOCIETY&quot;, NA, &quot;HEALTH&quot;, &quot;ENV&quot;, NA, &quot;MSCA&quot;, NA,…
## $ signature_date         &lt;date&gt; 2020-11-03, NA, 2014-12-03, 2019-05-03, NA, 20…
## $ call_deadline_date     &lt;date&gt; 2020-03-19, NA, 2014-04-15, 2018-09-04, NA, 20…
## $ eu_contribution        &lt;dbl&gt; 759875.0, NA, 1416150.8, 506900.0, NA, 160932.5…
## $ rcn                    &lt;dbl&gt; 231942, 185493, 194057, 223238, 103710, 235059,…
## $ proj_acronym           &lt;chr&gt; &quot;EiA&quot;, &quot;SLANDAIL&quot;, &quot;TBVAC2020&quot;, &quot;REACT&quot;, &quot;DOPA&quot;…
## $ start_date             &lt;date&gt; 2021-01-01, 2014-04-01, 2015-01-01, 2019-06-01…
## $ end_date               &lt;date&gt; 2023-12-31, 2017-03-31, 2019-06-30, 2022-05-31…
## $ legal_basis            &lt;chr&gt; &quot;H2020-EU.3.6.&quot;, &quot;FP7-SECURITY&quot;, NA, &quot;H2020-EU.…
## $ framework_programme    &lt;chr&gt; &quot;H2020&quot;, &quot;FP7&quot;, &quot;H2020&quot;, &quot;H2020&quot;, &quot;FP7&quot;, &quot;H2020…
## $ funding_scheme         &lt;chr&gt; &quot;CSA&quot;, &quot;CP-FP&quot;, &quot;RIA&quot;, &quot;RIA&quot;, &quot;CP&quot;, &quot;MSCA-IF-EF…
## $ thematic_priority      &lt;chr&gt; &quot;Europe in a changing world - inclusive, innova…
## $ topic_code             &lt;chr&gt; &quot;GOVERNANCE-20-2020&quot;, &quot;SEC-2013.6.1-1&quot;, &quot;PHC-08…
## $ topic_description      &lt;chr&gt; &quot;Centres/Networks of European research and inno…
## $ pillar                 &lt;fct&gt; III, NA, III, III, NA, I, NA, I, II, NA, NA, NA…
## $ org_type               &lt;fct&gt; Others (Excl. R&amp;Ed), Others (Excl. R&amp;Ed), Resea…
## $ country                &lt;chr&gt; &quot;Germany&quot;, &quot;United Kingdom&quot;, &quot;United Kingdom&quot;, …
## $ signature_year         &lt;int&gt; 2020, NA, 2014, 2019, NA, 2021, NA, 2021, 2015,…
## $ call_year              &lt;int&gt; 2020, NA, 2014, 2018, NA, 2020, NA, 2020, 2014,…
## $ start_year             &lt;int&gt; 2021, 2014, 2015, 2019, 2012, 2022, 2013, 2022,…</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
